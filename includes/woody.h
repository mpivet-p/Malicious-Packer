#pragma once

#include <stddef.h>
#include <elf.h>

//#define PAYLOAD_SIZE 49
//#define PAYLOAD_OPCODES "\x57\x56\x52\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x0f\x00\x00\x00\xba\x0e\x00\x00\x00\x0f\x05\x5a\x5e\x5f\xe9\xfb\xff\xff\xff\x2e\x2e\x2e\x2e\x57\x4f\x4f\x44\x59\x2e\x2e\x2e\x2e\x0a"
//#define PAYLOAD_SIZE 86
//#define PAYLOAD_OPCODES "\x57\x56\x52\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x34\x00\x00\x00\xba\x0e\x00\x00\x00\x0f\x05\x41\xb8\x53\x49\x5a\x45\x41\xb9\x42\x47\x49\x4e\xba\x59\x59\x45\x4b\x41\x8a\x19\xfe\xcb\x41\x88\x59\xfb\x49\xff\xc1\x49\xff\xc8\x4d\x85\xc0\x75\xec\x5a\x5e\x5f\xe9\xfb\xff\xff\xff\x2e\x2e\x2e\x2e\x57\x4f\x4f\x44\x59\x2e\x2e\x2e\x2e\x0a"
//#define PAYLOAD_SIZE 112
//#define PAYLOAD_OPCODES "\x57\x56\x52\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x4e\x00\x00\x00\xba\x0e\x00\x00\x00\x0f\x05\x41\xb8\x53\x49\x5a\x45\x4c\x8d\x0d\xd8\xff\xff\xff\x49\x81\xc1\x42\x47\x49\x4e\x41\xba\x59\x59\x45\x4b\xb8\x0a\x00\x00\x00\x4c\x89\xcf\x4c\x89\xc6\xba\x07\x00\x00\x00\x0f\x05\x41\x8a\x19\xfe\xcb\x41\x88\x19\x49\xff\xc1\x49\xff\xc8\x4d\x85\xc0\x75\xed\x5a\x5e\x5f\xe9\xfb\xff\xff\xff\x2e\x2e\x2e\x2e\x57\x4f\x4f\x44\x59\x2e\x2e\x2e\x2e\x0a"
//#define PAYLOAD_SIZE 121
//#define PAYLOAD_OPCODES "\x57\x56\x52\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x57\x00\x00\x00\xba\x0e\x00\x00\x00\x0f\x05\x41\xb8\x53\x49\x5a\x45\x4c\x8d\x0d\xd8\xff\xff\xff\x49\x81\xc1\x42\x47\x49\x4e\x41\xba\x4b\x45\x59\x20\xb8\x0a\x00\x00\x00\x4c\x89\xcf\x48\x81\xc7\x53\x47\x4d\x54\xbe\x53\x53\x49\x5a\xba\x07\x00\x00\x00\x0f\x05\x41\x8a\x19\xfe\xcb\x41\x88\x19\x49\xff\xc1\x49\xff\xc8\x4d\x85\xc0\x75\xed\x5a\x5e\x5f\xe9\xfb\xff\xff\xff\x2e\x2e\x2e\x2e\x57\x4f\x4f\x44\x59\x2e\x2e\x2e\x2e\x0a"

#define PAYLOAD_SIZE 119
#define PAYLOAD_OPCODES "\x57\x56\x52\xb8\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x8d\x35\x51\x00\x00\x00\xba\x0e\x00\x00\x00\x0f\x05\x41\xb8\x53\x49\x5a\x45\x4c\x8d\x0d\xd8\xff\xff\xff\x49\x81\xc1\x42\x47\x49\x4e\xb8\x0a\x00\x00\x00\x4c\x89\xcf\x48\x81\xc7\x53\x47\x4d\x54\xbe\x53\x53\x49\x5a\xba\x07\x00\x00\x00\x0f\x05\x41\x8a\x19\xfe\xcb\x41\x88\x19\x49\xff\xc1\x49\xff\xc8\x4d\x85\xc0\x75\xed\x5a\x5e\x5f\xe9\xfb\xff\xff\xff\x2e\x2e\x2e\x2e\x57\x4f\x4f\x44\x59\x2e\x2e\x2e\x2e\x0a\x78\x4b\x45\x59"

int	check_file(char *filepath);
int	get_file(const char *filepath, void **file, size_t *fsize);
int	woody(char *file_name, void *file, size_t fsize);
Elf64_Shdr	*get_section_header(void *file, char *name);
int		get_shstrtab_content(void *file, Elf64_Ehdr *ehdr, char **ptr);
void	encrypt_text_section(void *file, uint32_t key);
